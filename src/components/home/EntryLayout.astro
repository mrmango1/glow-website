---
import BaseLayout from "@components/base/BaseLayout.astro";
import { Image } from "astro:assets";
import glassLightIcon from "@assets/icons/GlassBar-Light.png";
import glassDarkIcon from "@assets/icons/GlassBar-Dark.png";

// Configuration - edit these values to customize
const imageAlt = "Glow - Transform Your Menu Bar";
const base = import.meta.env.BASE_URL.replace(/\/$/, '');
---

<BaseLayout>
  <!-- Google Font for elegant cursive title -->
  <link slot="head" rel="preconnect" href="https://fonts.googleapis.com" />
  <link slot="head" rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
  
  <!-- Vision Pro Product Showcase -->
  <section class="vp-showcase">
    <div class="vp-product-container">
      
      <!-- Left Column: Icon, Title & Info (Centered) -->
      <div class="vp-left-column">
        <!-- Product Icon -->
        <div class="vp-icon-container">
          <!-- Pulse rings with icon colors -->
          <div class="vp-pulse-ring vp-pulse-ring--green"></div>
          <div class="vp-pulse-ring vp-pulse-ring--yellow"></div>
          <div class="vp-pulse-ring vp-pulse-ring--orange"></div>
          <div class="vp-pulse-ring vp-pulse-ring--purple"></div>
          <div class="vp-pulse-ring vp-pulse-ring--blue"></div>
          <div class="vp-icon-frame">
            <Image
              class="vp-icon light-image"
              src={glassLightIcon}
              alt={imageAlt}
              width={1024}
              height={1024}
              loading="eager"
            />
            <Image
              class="vp-icon dark-image"
              src={glassDarkIcon}
              alt={imageAlt}
              width={1024}
              height={1024}
              loading="eager"
            />
          </div>
        </div>
        
        <!-- Typewriter Title -->
        <h1 class="vp-typewriter-title">
          <span class="vp-typewriter-text" data-text="Glow"></span>
          <span class="vp-typewriter-cursor"></span>
        </h1>

        <!-- Version & Tagline with cursive font -->
        <div class="vp-cursive-version">v 1.0</div>
        <p class="vp-cursive-tagline">Transform your menu bar into an organized, beautiful space</p>
      </div>

      <!-- Right Column: Specs & CTAs -->
      <div class="vp-right-column">
        <div class="vp-panel-glow" id="panel-glow"></div>
        <!-- Specifications Panel -->
        <div class="vp-specs-panel">
          <div class="vp-spec-item">
            <span class="vp-spec-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect>
                <rect x="9" y="9" width="6" height="6"></rect>
                <line x1="9" y1="1" x2="9" y2="4"></line>
                <line x1="15" y1="1" x2="15" y2="4"></line>
                <line x1="9" y1="20" x2="9" y2="23"></line>
                <line x1="15" y1="20" x2="15" y2="23"></line>
                <line x1="20" y1="9" x2="23" y2="9"></line>
                <line x1="20" y1="14" x2="23" y2="14"></line>
                <line x1="1" y1="9" x2="4" y2="9"></line>
                <line x1="1" y1="14" x2="4" y2="14"></line>
              </svg>
            </span>
            <span class="vp-spec-label">Chip</span>
            <span class="vp-spec-value">Apple Silicon/Intel</span>
          </div>
          <div class="vp-spec-item">
            <span class="vp-spec-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                <path d="M2 17l10 5 10-5"></path>
                <path d="M2 12l10 5 10-5"></path>
              </svg>
            </span>
            <span class="vp-spec-label">Type</span>
            <span class="vp-spec-value">Native</span>
          </div>
          <div class="vp-spec-item">
            <span class="vp-spec-icon vp-spec-icon--apple">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/>
              </svg>
            </span>
            <span class="vp-spec-label">macOS</span>
            <span class="vp-spec-value">
              <span class="vp-badge">26+</span>
            </span>
          </div>
        </div>

        <!-- CTA Buttons -->
        <div class="vp-cta">
          <a href={`${base}/download`} class="vp-button primary" data-glow-color="primary">
            <svg class="vp-button-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/>
            </svg>
            <span class="vp-button-content">
              <span class="vp-button-text">Download for Mac</span>
              <span class="vp-button-subtext">Free Trial</span>
            </span>
          </a>
          <a href={`${base}/pricing`} class="vp-button secondary" data-glow-color="secondary">
            <svg class="vp-button-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
              <line x1="7" y1="7" x2="7.01" y2="7"></line>
            </svg>
            <span class="vp-button-content">
              <span class="vp-button-text">Purchase</span>
              <span class="vp-button-subtext">$5.99 one-time</span>
            </span>
          </a>
          <a href={`${base}/features`} class="vp-button tertiary" data-glow-color="tertiary">
            <svg class="vp-button-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
            </svg>
            <span class="vp-button-content">
              <span class="vp-button-text">Explore Features</span>
              <span class="vp-button-subtext">See what's included</span>
            </span>
          </a>
        </div>

        <!-- Footer Info -->
        <div class="vp-footer-info">
          Privacy-first • No subscriptions • macOS 26+
        </div>
      </div>

    </div>
  </section>
</BaseLayout>

<script>
  function initHomeEffects() {
    // Typewriter effect
    const typewriterElement = document.querySelector('.vp-typewriter-text') as HTMLElement;
    if (typewriterElement) {
      // Check if animation already running or completed
      if (typewriterElement.dataset.animating === 'true' || typewriterElement.dataset.completed === 'true') {
        return;
      }
      
      // Mark as animating
      typewriterElement.dataset.animating = 'true';
      
      // Clear any existing letters
      typewriterElement.innerHTML = '';
      
      const text = typewriterElement.dataset.text || 'Glow';
      // Colors: yellow, orange, purple, light blue
      const colors = ['#E6C068', '#E67E45', '#9575CD', '#64B5F6'];
      let currentIndex = 0;
      
      const typeNextLetter = () => {
        if (currentIndex < text.length) {
          const color = colors[currentIndex % colors.length];
          const span = document.createElement('span');
          span.textContent = text[currentIndex];
          span.style.color = color;
          span.style.textShadow = `0 0 10px ${color}, 0 0 20px ${color}, 0 0 30px ${color}, 0 0 40px ${color}`;
          span.classList.add('vp-letter');
          span.style.setProperty('--letter-color', color);
          typewriterElement.appendChild(span);
          currentIndex++;
          setTimeout(typeNextLetter, 180);
        } else {
          // Mark as completed
          typewriterElement.dataset.animating = 'false';
          typewriterElement.dataset.completed = 'true';
        }
      };
      
      // Start typing after a short delay
      setTimeout(typeNextLetter, 800);
    }
    
    // Panel glow color change on button hover
    const panelGlow = document.getElementById('panel-glow');
    const buttons = document.querySelectorAll('.vp-button[data-glow-color]');
    
    if (panelGlow && buttons.length > 0) {
      buttons.forEach(button => {
        const htmlButton = button as HTMLElement;
        // Skip if already initialized
        if (htmlButton.dataset.glowInit === 'true') return;
        htmlButton.dataset.glowInit = 'true';
        
        htmlButton.addEventListener('mouseenter', () => {
          const glowColor = htmlButton.getAttribute('data-glow-color');
          panelGlow.setAttribute('data-color', glowColor || '');
        });
        
        htmlButton.addEventListener('mouseleave', () => {
          panelGlow.removeAttribute('data-color');
        });
      });
    }
  }

  // Run on Astro page navigation (View Transitions) - this handles both initial load and navigation
  document.addEventListener('astro:page-load', initHomeEffects);
</script>

<style lang="scss">
  @use "@/styles/components/entry-layout";
</style>
